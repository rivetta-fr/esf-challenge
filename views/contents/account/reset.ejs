<!-- views/forgot.ejs -->
<div class="container">
		<h1><span class="fa fa-sign-in"></span><%= __('Update Password') %></h1>
		<!-- LOGIN FORM -->
		<form id="resetform" name="resetform" action="/reset/<%= token %>" method="post">
			<!-- *******************add old password check********************* -->
			<div class="form-group">
				<label><%= __('Password') %></label>
				<input type="hidden" value="<%= email %>" name="email">
				<input id="password" type="password" class="form-control" name="password">
			</div>
			<div class="form-group">
				<label><%= __('Confirm Password') %></label>
				<input id="confirm" type="password" class="form-control" name="confirm">
			</div>
			<button type="submit" class="btn btn-perso btn-lg"><%= __('Update password') %></button>
		</form>

		<hr>

</div>
<script>
	$(document).on('submit',"#resetform",function (event) {
		event.preventDefault();
		// Check each field has a value
		if (  this.password.value == ''  || this.confirm.value == '') {
			appendAlert("#password","<%= __('Vous devez fournir tous les informations demandées. Veuillez réessayer') %>" );
			return false;
		}

		// Check that the password is sufficiently long (min 6 chars)
		// The check is duplicated below, but this is included to give more
		// specific guidance to the user
		if (this.password.value.length < 6) {
			appendAlert("#password","<%= __('Les mots de passe doivent comporter au moins 6 caractères. Veuillez réessayer') %>" );
			this.password.focus();
			return false;
		}

		// At least one number, one lowercase and one uppercase letter
		// At least six characters

		const re = /(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;
		if (!re.test(password.value)) {
			appendAlert("#password","<%= __('Les mots de passe doivent contenir au moins un chiffre, une minuscule et une majuscule. Veuillez réessayer') %>" );
			this.password.focus();
			return false;
		}


		// Check password and confirmation are the same
		if (this.password.value != this.confirm.value) {
			appendAlert("#password","<%= __('Votre mot de passe et votre confirmation ne correspondent pas. Veuillez réessayer') %>");
			this.password.focus();
			return false;
		}
		this.submit();
	});
</script>
